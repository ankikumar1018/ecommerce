# Frontend Complete Setup & Usage Guide

## ğŸ“‹ Overview

The ShopSphere frontend is a modern React SPA (Single Page Application) built with:
- **React 18.2** for UI
- **Vite 5.1** for blazingly fast development and production builds
- **React Router 6** for client-side routing
- **Axios** for HTTP requests
- **Context API** for state management
- **CSS3** with responsive design

## ğŸš€ Quick Start

### Local Development

```bash
# Install dependencies
npm install

# Start dev server
npm run dev

# Open browser to http://localhost:3000
```

### Production Build

```bash
# Build for production
npm run build

# Preview production build
npm run preview
```

## ğŸ“ Project Structure

```
frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.jsx                    # App root with providers
â”‚   â”œâ”€â”€ api.js                      # Axios client with interceptors
â”‚   â”œâ”€â”€ config.js                   # Environment configuration
â”‚   â”œâ”€â”€ utils.js                    # Utility functions
â”‚   â”œâ”€â”€ styles.css                  # Global styles
â”‚   â”œâ”€â”€ context/
â”‚   â”‚   â”œâ”€â”€ AuthContext.jsx         # Auth state (user, token, login/logout)
â”‚   â”‚   â””â”€â”€ CartContext.jsx         # Cart state (items, total, checkout)
â”‚   â””â”€â”€ pages/
â”‚       â”œâ”€â”€ Products.jsx            # Product listing with variants
â”‚       â”œâ”€â”€ Cart.jsx                # Shopping cart & checkout
â”‚       â”œâ”€â”€ Login.jsx               # User authentication
â”‚       â””â”€â”€ Register.jsx            # User registration
â”œâ”€â”€ dist/                           # Built assets (generated by npm run build)
â”œâ”€â”€ index.html                      # HTML entry point
â”œâ”€â”€ vite.config.js                  # Vite configuration
â”œâ”€â”€ Dockerfile                      # Docker containerization
â”œâ”€â”€ package.json                    # Dependencies and scripts
â”œâ”€â”€ .env.example                    # Environment variables template
â””â”€â”€ README.md                       # Frontend README
```

## âš™ï¸ Environment Configuration

### Development

Create `.env.local`:
```env
VITE_API_BASE=http://localhost:8000
```

### Production

Set environment variable before build:
```bash
VITE_API_BASE=https://api.shopsphere.com npm run build
```

### Available Variables

- `VITE_API_BASE` - Backend API URL (default: `http://localhost:8000`)
- `VITE_ENV` - Environment name (development, staging, production)

## ğŸ¯ Core Features

### 1. **Authentication (AuthContext)**

```javascript
import { useAuth } from './context/AuthContext'

function MyComponent() {
  const { user, token, setToken, logout, loading } = useAuth()
  
  return (
    <div>
      {token ? (
        <>
          <p>Logged in as {user?.username}</p>
          <button onClick={logout}>Logout</button>
        </>
      ) : (
        <p>Please login</p>
      )}
    </div>
  )
}
```

**Key Methods:**
- `setToken(token)` - Set authentication token after login
- `logout()` - Clear auth and redirect to login
- Auto-saves token to localStorage
- Auto-loads token on app start

### 2. **Shopping Cart (CartContext)**

```javascript
import { useCart } from './context/CartContext'

function ProductCard({ product }) {
  const { cart, addToCart, removeFromCart } = useCart()
  
  return (
    <div>
      <h3>{product.name}</h3>
      <button onClick={() => addToCart(product.variant_id, 1)}>
        Add to Cart
      </button>
      <p>Items: {cart?.total_items || 0}</p>
    </div>
  )
}
```

**Key Methods:**
- `addToCart(variantId, quantity)` - Add item to cart
- `removeFromCart(itemId)` - Remove item
- `updateCartItem(itemId, quantity)` - Update quantity
- `checkout(paymentMethod)` - Process order
- Stores cart state in context (synced with backend)

### 3. **API Integration**

The `api.js` module provides:
- Pre-configured Axios instance
- Automatic JWT token injection in headers
- Response interceptor for 401 auth errors
- Centralized error handling

```javascript
import api from './api'

// Automatically includes auth header
const resp = await api.get('products/')

// Error handling
try {
  await api.post('checkout/', { payment_method: 'card' })
} catch (error) {
  console.error(error.response.data)
}
```

### 4. **Pages**

#### Products Page
- Lists all products with variants
- Expandable variant details (SKU, color, size, price, stock)
- Add to cart with quantity selector
- Requires login to add to cart
- Loading and error states

#### Cart Page
- Displays cart items with details
- Update quantities inline
- Remove items
- Order summary with totals
- Payment method selection
- Checkout button
- Auto-redirect to login if not authenticated

#### Login Page
- Username/password form
- Form validation
- Password visibility toggle
- Error message display
- Demo credentials shown
- Link to registration

#### Register Page
- Username, email, password form
- Password confirmation
- Form validation with specific error messages
- Auto-redirect to login on success
- Link to login page

## ğŸ¨ Styling System

### CSS Variables (Theme)

```css
:root {
  --primary: #2563eb;        /* Main brand color */
  --primary-hover: #1d4ed8;  /* Hover state */
  --secondary: #64748b;      /* Secondary text */
  --success: #10b981;        /* Success messages */
  --danger: #ef4444;         /* Errors/dangers */
  --warning: #f59e0b;        /* Warnings */
  --gray-*: ...;             /* Grayscale palette */
  --border-radius: 8px;      /* Border radius */
  --transition: all 0.3s ease; /* Transitions */
}
```

### Component Classes

- `.container` - Max-width container (1200px)
- `.btn`, `.btn-primary`, `.btn-secondary`, `.btn-danger`
- `.form`, `.form-group`, `.form-input`
- `.grid` - Responsive product grid
- `.product-card` - Product display card
- `.cart-*` - Cart related styles
- `.auth-form` - Auth page form

### Responsive Breakpoints

```css
/* Mobile first */
/* Default: < 768px */

@media (max-width: 768px) {
  /* Tablet and up */
}

@media (min-width: 1200px) {
  /* Desktop */
}
```

## ğŸ”„ Data Flow

```
User Action
    â†“
Component â†’ useAuth() / useCart()
    â†“
Context Hook
    â†“
API Call (api.js)
    â†“
axios.post/get/patch/delete
    â†“
Backend Response
    â†“
Context State Update
    â†“
Component Re-render
```

## ğŸ³ Docker & Deployment

### Build Docker Image

```bash
# Ensure dist is built locally
npm run build

# Build Docker image
docker build -t shopsphere-frontend .

# Run container
docker run -p 80:80 shopsphere-frontend
```

### Docker Compose

```bash
docker compose up frontend
```

### Production Deployment

The frontend is served via Nginx in Docker:

```dockerfile
FROM nginx:stable-alpine
COPY ./dist /usr/share/nginx/html
EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]
```

**Key Deployment Considerations:**
- `npm run build` must be run locally before Docker build
- Build output on your machine, deploy to production
- Nginx caches dist files aggressively
- CORS headers configured in backend

## âš¡ Performance Tips

### Development
- HMR (Hot Module Replacement) enabled
- Fast Refresh for React
- Source maps for debugging

### Production
- Minified JavaScript & CSS
- Tree shaking removes unused code
- Code splitting for optimized bundle
- No console logs in production
- Gzip compression via Nginx

### Runtime
- Lazy route loading (future)
- Image lazy loading
- Efficient context updates
- Memoization for expensive computations

## ğŸ§ª Testing

### Manual Testing Checklist

- [ ] Register new account
- [ ] Login with credentials
- [ ] View products
- [ ] Expand product variants
- [ ] Add products to cart
- [ ] View cart
- [ ] Update cart item quantities
- [ ] Remove items from cart
- [ ] Checkout with different payment methods
- [ ] Logout
- [ ] Mobile responsiveness
- [ ] Error handling (try invalid credentials)

### Automated Testing (Future)

```bash
npm install --save-dev vitest @testing-library/react

npm run test
```

## ğŸ” Security Features

âœ… JWT token-based authentication
âœ… Secure password input (visibility toggle)
âœ… CSRF protection (backend)
âœ… Input validation
âœ… Automatic logout on 401
âœ… Token stored in localStorage (consider httpOnly in future)
âœ… No sensitive data in browser storage

## ğŸ› Debugging

### Browser DevTools

1. **Network Tab**
   - Check API requests/responses
   - Verify headers (Authorization)
   - Look for CORS issues

2. **Console Tab**
   - Check for errors
   - Verify environment variables: `import.meta.env`

3. **Application Tab**
   - Check localStorage for token
   - Verify context state in React DevTools

### Common Issues

**Issue:** "CORS error"
- **Cause:** Backend not allowing frontend origin
- **Fix:** Check CORS settings in Django settings.py

**Issue:** "404 on API calls"
- **Cause:** Wrong API base URL
- **Fix:** Set `VITE_API_BASE` correctly

**Issue:** "Blank page after building"
- **Cause:** dist/ not built
- **Fix:** Run `npm run build` locally

**Issue:** "Login doesn't work"
- **Cause:** Backend not running or wrong credentials
- **Fix:** Check backend is at http://localhost:8000

## ğŸ“š Useful Commands

```bash
# Development
npm run dev              # Start dev server

# Building
npm run build            # Build for production
npm run preview          # Preview production build locally

# Code Review
npm run lint             # Lint code (if eslint configured)

# Maintenance
npm update              # Update dependencies safely
npm audit               # Check for vulnerabilities
npm install             # Install dependencies
```

## ğŸš€ Deployment Workflow

### local Machine
```bash
# 1. Update code and test locally
npm run dev

# 2. Build for production
npm run build

# 3. Commit changes
git add .
git commit -m "Update frontend"

# 4. Push to repository
git push origin main
```

### CI/CD Pipeline (GitHub Actions)
```yaml
- name: Build frontend
  run: npm run build

- name: Build Docker image
  run: docker build -t frontend .

- name: Push to registry
  run: docker push frontend:latest
```

### Production Server
```bash
# Pull latest image
docker pull frontend:latest

# Run container
docker run -p 80:80 frontend:latest
```

## ğŸ“– Additional Resources

- [React Docs](https://react.dev)
- [Vite Docs](https://vitejs.dev)
- [React Router Docs](https://reactrouter.com)
- [Axios Docs](https://axios-http.com)
- [MDN CSS Reference](https://developer.mozilla.org/en-US/docs/Web/CSS)

## âœ… Checklist for Production

- [ ] Environment variables configured
- [ ] API base URL correct for production
- [ ] npm run build tested locally
- [ ] Docker image builds successfully
- [ ] All pages tested in production build
- [ ] Mobile responsiveness checked
- [ ] Error handling verified
- [ ] Performance acceptable
- [ ] Security headers configured
- [ ] CORS settings correct on backend
- [ ] Monitoring/logging configured
- [ ] Backup/rollback plan ready

## ğŸ“ Support

For issues or questions:
1. Check this guide
2. Review README.md
3. Check GitHub Issues (if available)
4. Review backend logs if API issues
